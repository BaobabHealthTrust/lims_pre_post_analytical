
  <%= javascript_include_tag "jquery" %>
  <%= javascript_include_tag "bootstrap" %>
  <%= stylesheet_link_tag "bootstrap.min" %>
  <%= stylesheet_link_tag "extras/footer" %>
  <%= javascript_include_tag "sw.min" %>

<style type="text/css">
	
	#barcode-txt {
  border-color: black;
  border-style: solid;
  border-width: 0 0 1px;
  font-size: 30px;
  margin: 3% 4%;
  width: 60%
}	

</style>
<div style=" height: 97%;" class="container-fluid">
<div class="row">
		<div class="col-sm-4" style="height: 32%; margin-top: 1%; margin-left: 2%;
			 background: -moz-linear-gradient(right,rgba(62, 69, 81, 0.7),rgba(62, 69, 81, 0.3)); 
			 box-shadow: 10px 10px 5px lightgrey; border-radius: 2%;">

			<h1 style="color: white;text-shadow: 2px 2px 4px #000000;">LIMS Order Entry</h1>
				<p style="color: black;text-shadow: 2px 2px 4px #000000; font-weight:bold;">Facility Name <br/>
					<span class="color:white;" style="">Kawale Health Centre</span></p>

					<p style="color: black;text-shadow: 2px 2px 4px #000000;;font-weight:bold;">Ward/Location <br/>
					<span class="text-white" style=""><%= session[:ward] %></span>
				</p>

		</div>

		<div class="col-sm-7" style="margin-top: 1%;">
			<div style=" overflow: auto; height: 32%; padding-top: 1%;padding-left: 1%;padding-right: 1%;border: thin solid lightgrey;
			    ">

				<div>	
						<div class="col-sm-8">
							
					
						</div>
						<div class="col-sm-4">
							<div class="panel panel-default" style="color: red;box-shadow: 10px 10px 5px lightgrey;">
								<h4 style="text-align: center;">System  User Roles</h4>
							</div>
							
						</div>
				</div>
				<div  style="margin-top: 12.8%;">
					<div class="col-sm-4">
						<div class="panel panel-default" style="color: orange;box-shadow: 10px 10px 5px lightgrey;">
							<div  class="panel-heading" style="color: #1c2a48 ; font-weight:bold; text-align: center;">Orders with No Results</div>
							<div class="panel-body" style="font-size: 2em;font-weight:bold; text-align: center;">1000 </div>
						</div>
					</div>

					<div class="col-sm-4">
						<div class="panel panel-default" style="color:lightgreen;box-shadow: 10px 10px 5px lightgrey;">
							<div  class="panel-heading" style="color: #1c2a48 ; font-weight:bold; text-align: center;">Samples Not Drawn</div>
							<div class="panel-body" style="font-size: 2em; font-weight:bold; text-align: center;">1000 </div>
						</div>
					</div>

					<div class="col-sm-4">
						
						<div class="panel panel-default" style="color: blue;box-shadow: 10px 10px 5px lightgrey;">
							<% undispatched_sample_count = session[:un_dis_sample] %>
									<% if undispatched_sample_count >0 %>
										<div  class="panel-heading" style="color:red; font-weight:bold; text-align: center;">Samples Not dispatched</div>
										<div class="panel-body" style="font-size: 2em; color:red; font-weight:bold; text-align: center;">
											<%= undispatched_sample_count %></div>
									<% else %>
										<div  class="panel-heading" style="color:#1c2a48; font-weight:bold; text-align: center;">Not dispatched</div>
										<div class="panel-body" style="font-size: 2em; color:#1c2a48; font-weight:bold; text-align: center;">
										<%= undispatched_sample_count %></div>
									<% end %>

						</div>
					</div>
			    </div>
			</div>
		</div>
	</div>






	<div class="row">
		<div style="border: thick solid lightgrey; height: 55%;margin-left: 2%;margin-right: 2%; margin-top: 1%;
		overflow: auto;
		">
			
			<div class="panel-body" style=" overflow: auto; overflow-x: hidden; height: 65%;">
				<table class="table">
					<thead>
						<tr>
								<th>User Types</th>
							<% if !@roles.blank? %>

								<% @roles.each do |role| %>
									<th> <%= role['name']%> </th>
								<% end %>
							<% else %>

							<% end %>
						</tr>
					</thead>
					
					<tbody>
						<% if !@asigned_roles.blank? %>
								<% counter =0 %>
								<% @asigned_roles.each do |type| %>							
									<tr>
										<td>
											<%= type[0] %>
										</td>
										<% @roles.each do |role| %>
											<% if type[1][counter] == "yes" %>
												<th> <input id="<%= role['name'] +'_'+ type[0] %>" 
													type="checkbox" name="rl()"
													value ="<%= role['name'] +'_'+ type[0] %>"
													onclick="assign_deasign_roles(this.id,this.value)"
													checked>
												</th>
											<% else %>
												<th> <input id="<%= role['name'] +'_'+ type[0] %>" 
													type="checkbox" name="rl()"
													value ="<%= role['name'] +'_'+ type[0] %>"
													onclick="assign_deasign_roles(this.id,this.value)">
												</th>
											<% end %>
											<% counter = counter + 1 %>
										<% end %>
										<% counter = 0 %>
									</tr>
								<% end %>
						<% end %>
					</tbody> 
										
				</table>
				
			</div>

		</div>
	</div>

</div>
		
<div class="footer">
  <button class="btn-back" onmousedown="document.location='/home'"> <|Back</button>
  

   <span style="float: right;">
	    <button class="btn btns btn-lg btn-danger"	id="log_out" onmousedown="document.location='/home'">
	     	Cancel
	   	</button>
	  
	   <button class="btns btn btn-lg btn-primary" 
	     					id="log_out"
	     					onmousedown="send_roles()">
	     				Save
	    </button>
		<button class="btns btn btn-lg btn-danger" 
	     					id="log_out"
	     					onmousedown="document.location='/'">
	     				Log Out
	    </button>
    </span>
</div>

<script type="text/javascript">
 var roles = {};

 function assign_deasign_roles(control_id,role_user_type)
 {	var role = role_user_type.split('_')[1];
 	var userType = role_user_type.split('_')[0];
 	var con = document.getElementById(control_id);

 	if (con.checked == true)
 	{
 		roles[role_user_type] = "yes"; 	
 	}	
 	else if (con.checked == false)
 	{
 		roles[role_user_type] = "no"; 		
 	}
 
 }

 function send_roles()
 {
 	var url_ = "/system_roles"; 	
 	jQuery.ajax({
 					async: false,
 					url: url_,
 					type: 'post',
 					data: roles,
 					success: function(res)
 					{
 						swal("Confirmation","User System Roles Successfuly Updated","success");
 					},
 					error: function(err)
 					{	
 						console.log(err);
 					}
 	})
 }

</script>